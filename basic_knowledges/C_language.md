# C语言进阶
[toc]
## C专家编程
[C专家编程+清晰+（有书签索引）.pdf](../../../books/C语言/C专家编程+清晰+（有书签索引）.pdf)
看书时间：11月27日-12月10日（13天，24.5h） 
书评：本书从C语言的出生开始讲起，包括C语言特性的产生，标准的建立，内部存在的一些机制，让你有除语法之外更深入的了解；C语言的语言特性造成的一些问题，C语言的缺陷；C语言的声明，如何分解一串声明，typedef的用法，以及typedef与struct连用与单独用struct的区别；指针和数组不能混用的情况；介绍了动态链接和静态链接，以及interposing问题；a.out的段结构，程序运行的情况，调用函数时的堆栈情况，setjmp/longjmp用于错误恢复，C语言有一些工具；关于内存，虚拟内存；类型提升，函数原型，C语言实现有限状态机（函数指针），Hash表，强制类型转换；数组和指针可以互换的情况，多维数组；多维数组的内存发布，指针数组；C++的特性；
* 序可以仔细读一读，开头是引语，俏皮话不用划线的......
* “小启发”：实际工作的一些想法、经验和指导方针
* C语言从一个1969年一个失败了操作系统项目Multics，这个项目啥都没弄出来，但成了总结工程教训的宝库，1970年Thompson用汇编写了比Mutlics简单、轻便的操作系统Unix。
* 汇编写Unix很笨拙、代码不易理解，为提高效率且避免Multics里遇到的麻烦，Thompson创建了B语言，但并不成功（低效、硬件限制、解释器）
* 编译器设计原则：运行效率和编译效率（保证结果正确）
* B无法表达不同数据类型，Dennis创立同时解决多种数据类型并保证效率的New B，后变为 C语言，特点：编译，类型系统，变量先说明后使用
* C语言的特性与硬件十分相关，并且方便编译器设计者
  * 数组下标从0开始——偏移量概念
  * 基本数据类型——与硬件相关，底层硬件支持不同数据类型
  * auto 自动内存分配，变量默认分配模式——方便编译器设计者
  * 表达式中的数组名看做指针——简化编译器
  * 不允许嵌套函数（函数内部包含另一函数定义）——简化编译器
  * register 关键字，把变量分配到寄存器中——方便编译器
* C语言中，大多数库函数和辅助程序需要显示调用——C++改造函数和析构函数自动调用
* 预处理器与标准IO库大约同时出现（1972年），实现三个主要功能：
  * 字符串替换：可为常量提供一个符号名
  * 头文件包含：一般性说明被分离到头文件中，可以被多个源文件使用
  * 通用代码模板拓展：与函数不同，宏在连续几个调用中所接收的参数的类型可以不同
  * ！！！宏拓展中，空格会影响拓展结果！！！
    ```
    #define a(y) a_expanded(y)
    与
    #define a (y) a_expanded (y)
    后者被拓展为
    a(x) : (y) a_expanded (y)(x)
    ```
  * !在宏里使用花括号也不会把多条语句组合成一条复合语句，建议适量使用，在C++有新方法可以替代预处理器
  * 有人用C语言的预处理器修改过C语言语法结构，但难以维护
    * 宏最好只用来变量命名，并为一些适当结构提供简洁记法
    * ！宏名应该大写与函数调用分开
* 20世纪70年代中期，C语言已经很接近现在的C语言了，1978年steve编写了pcc这个可移植的C编译器，成为一代编译器的基础（同年，The C programming Language出版，K＆R C出现）
* 复合赋值符引入了一个麻烦：如何东西跟在赋值符的后面都会被换序，而且不会报错，所以赋值符后勤加空格
* 随着多种编译器兴起，C语言渐渐变得松散，1983年 美国国家标准化组织（ANSI）开始标准化工作
* ANSI C标准术语：不可移植的代码（未确定的），坏代码（未定义的，约束条件）；可移植的代码（遵循标准，保证无论在说明平台都能输出相同的输出，依赖编译器）
  * 保证可移植性，应该始终加上必要的类型转换、返回值等
  * 不遵循标准，但不是约束条件，编译器不会给警告......
* 标准规定编译器只**在违反语法规则和约束条件的情况下**才出错误信息
  * 未定义的（不对但标准没规定怎么做），比如标准规定C语言说明的标识符均保留，所以不能声明malloc(),但这不是约束条件，违反它编译器不会警告，导致interpositioning问题
* ANSI C标准的结构：术语介绍，系统环境，C语言标准，C运行库；附录F：一般警告消息，附录G：可移植性话题（集中建议）
* 标准不是必然完整一致正确的：标准设立后不轻易改动，即使修改错误
* K ＆ R C 与 ANSI C的区别：
  * 1. 新的、不同的、重要的东西——**原型**
  * 2. 新关键字
  * 3. 安静的改变——相邻字符串字面值会自动连接
  * 4. 除上述三者之外，包括争议内容
* P19 实参和形参不相容问题（`char* s`和`const char *p`）
### C语言的缺陷

### C语言的声明
### 指针与数组
### 链接
### 程序运行与内存
### 其他细节
### C++